/* awesome-menu 25-04-2016*/

!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b(a)}):void 0!==typeof module&&module.exports?module.exports=b(require("jquery")):a.Menu=b(a.jQuery)}(window||{},function(a){var b=function(b){return a(document.createElement(b))},c=function(a,b){if("object"!=typeof b)return null;for(var c in a)a.hasOwnProperty(c)&&void 0===b[c]&&(b[c]=a[c])},d=function(a,b){return void 0===b?a:e(b)},e=function(a){return{"true":!0,"false":!1}[a]},f=function(a){this.checkOptions(a),this.menu=b("menu"),this.currentSelected={}};return f.prototype={START_LEVEL:1,LEVEL_STEP:1,DEFAULT_HIDE_AFTER_SELECTED:!1,DEFUALT_HIDE_AFTER_SELECTED_TIME:50,DEFAULT_POSITION:"bottom",ONLY_ONE_EXPANSION:!0,DEFAULT_CHILD_EXPANSION:!0,DEFAULT_CHILD_FOLD_EVENT:"click",DEFAULT_CHILD_EXPAND_EVENT:"click",DEFAULT_SELECT_EVENT:"click",DEFAULT_MENU_CLASS:"",DEFAULT_LIST_CLASS:"",DEFAULT_WRAP_CLASS:"",DEFAULT_ITEM_CLASS:"",DEFAULT_SELECTED_CLASS:"selected",DEFAULT_HOVER_CLASS:"hover",LIST_TAG:"dl",WRAP_TAG:"dt",ITEM_TAG:"a",POSITION_SELECTOR:{top:{position:"absolute",left:0,bottom:"100%"},bottom:{position:"relative",left:0,top:0},right:{position:"absolute",left:"100%",top:0},left:{position:"absolute",right:"100%",top:0}},DEFAULT_CLASS:{menu:{display:"inline-block",padding:0,margin:0},list:{margin:0},wrap:{},item:{display:"block","white-space":"nowrap"}},getFilterString:function(a){return"[data-id="+a.id+"][data-level="+a.level+"]"},getListLevel:function(a){for(var b=1,c=-1,d=0;d<a.length;d++)a[d].list&&(c++,b+=this.getListLevel(a[d].list));return b-Math.max(0,c)},getLevelConfig:function(a){return 0==a?{position:this.DEFAULT_POSITION,childExpansion:this.DEFAULT_CHILD_EXPANSION,childExpandEvent:this.DEFAULT_CHILD_EXPAND_EVENT,childFoldEvent:this.DEFAULT_CHILD_FOLD_EVENT,selectEvent:this.DEFAULT_SELECT_EVENT,selectedClass:this.DEFAULT_SELECTED_CLASS,hideAfterSelected:this.DEFAULT_HIDE_AFTER_SELECTED,hoverClass:this.DEFAULT_HOVER_CLASS,listClass:this.DEFAULT_LIST_CLASS,wrapClass:this.DEFAULT_WRAP_CLASS,itemClass:this.DEFAULT_ITEM_CLASS}:this.options.levelConfig[a.toString()]},hasSubList:function(a){return 0===a.siblings(this.LIST_TAG).length},completeLevelConfig:function(){for(var a=1;a<=this.totalLevel;a++)void 0===this.getLevelConfig(a)&&(this.options.levelConfig[a.toString()]={}),c(this.getLevelConfig(a-1),this.getLevelConfig(a))},checkOptions:function(b){this.options=a.extend({selectedFunc:function(){}.bind(this),list:[],levelConfig:{}},b),this.totalLevel=this.getListLevel(this.options.list),this.completeLevelConfig()},getSelectedItemData:function(b){var c=[],d=b.parents(this.LIST_TAG);return Array.prototype.pop.call(d),c.push({id:b.attr("data-id"),name:b.attr("data-name"),level:b.attr("data-level"),isLastLevel:this.hasSubList(b)}),0!==d.length&&a.each(d,function(b,d){c.push({id:a(d).siblings().attr("data-id"),name:a(d).siblings().attr("data-name"),level:a(d).siblings().attr("data-level"),isLastLevel:this.hasSubList(a(d).siblings())})}.bind(this)),c},clearSelection:function(){var b=this.menu.find(this.LIST_TAG);a.each(b,function(b,c){var d=a(c).attr("data-selected-class");a(c).children().each(function(){var b=a(this).children(this.ITEM_TAG);b.removeClass(d)})})},recurseSelection:function(a){var b=this.getFilterString(a),c=this.menu.find(b);if(0===c.length)return null;var d=c.parent().parent(),f=d.siblings(this.ITEM_TAG),g=d.attr("data-selected-class"),h=e(d.attr("data-hide-after-selected"));return h&&setTimeout(function(){d.hide()},this.SELECTED_DISAPPEARED_TIME),c.addClass(g),0===f.length?null:this.recurseSelection({id:f.attr("data-id"),level:f.attr("data-level")})},select:function(a){if("object"!=typeof a)return null;if(void 0===a.id||void 0===a.level)return null;var b=this.getFilterString(a),c=this.menu.find(b);if(0===c.length)return null;var e=this.getSelectedItemData(c);this.currentSelected=e[0],d(this.ONLY_ONE_EXPANSION,this.options.onlyOneExpansion)&&this.handleExpansion(),this.clearSelection(),this.recurseSelection(a),this.options.selectedFunc.call(this,e)},handleExpansion:function(){var b=this.getFilterString(this.currentSelected);a.each(this.menu.children().children(),function(c,d){var e=a(d).find(b);0===e.length&&a(d).children(this.LIST_TAG).hide()}.bind(this))},constructMenuList:function(a,c){var d=b(this.LIST_TAG).attr({"class":a.listClass,"data-selected-class":a.selectedClass,"data-hide-after-selected":a.hideAfterSelected});return a.listClass||d.css(this.DEFAULT_CLASS.list),e(c.childExpansion)?d.show():d.hide(),d},constructMenuItem:function(a,c,d){var e=b(this.WRAP_TAG).attr({"class":d.wrapClass}).css({position:"relative"});d.wrapClass||e.css(this.DEFAULT_CLASS.wrap);var f=b(this.ITEM_TAG);return f.html(a.content).attr({"class":d.itemClass,"data-id":a.id,"data-name":a.name,"data-level":c}).appendTo(e),d.itemClass||e.css(this.DEFAULT_CLASS.item),e},setMenuListPosition:function(a,b){b.css(this.POSITION_SELECTOR[a])},constructMenu:function(b,c){var d=this.getLevelConfig(c),e=this.getLevelConfig(c-1),f=this.constructMenuList(d,e);return a.each(b,function(a,b){var e=this.constructMenuItem(b,c,d).appendTo(f);this.bindHoverEvent(e,d.hoverClass),b.list&&e.append(this.constructMenu(b.list,c+this.LEVEL_STEP))}.bind(this)),this.setMenuListPosition(d.position,f),this.bindExpansionEvent(d,f),this.bindSelectionEvent(d,f),f},bindExpansionEvent:function(b,c){var d=this;b.childExpandEvent===b.childFoldEvent?c.children().on(b.childExpandEvent,function(b){b.stopPropagation(),a(b.target).siblings(d.LIST_TAG).toggle()}):(c.children().on(b.childExpandEvent,function(b){a(this).children(d.LIST_TAG).show()}),c.children().on(b.childFoldEvent,function(b){a(this).children(d.LIST_TAG).hide()}))},bindHoverEvent:function(b,c){var d=this;b.on("mouseenter",function(b){a(this).children(d.ITEM_TAG).addClass(c)}).on("mouseleave",function(b){a(this).children(d.ITEM_TAG).removeClass(c)})},bindSelectionEvent:function(b,c){var d=this,e=c.children().children().filter(function(){return this.nodeName.toLowerCase()===d.ITEM_TAG});e.on(b.selectEvent,function(b){if(this.nodeName.toLowerCase()===d.ITEM_TAG){var c=d.getSelectedItemData(a(this));d.select({id:c[0].id,level:c[0].level})}})},render:function(){var a=this.constructMenu(this.options.list,this.START_LEVEL);return this.menu.attr({id:this.options.menuId,"class":this.options.menuClass}),this.options.menuClass||this.menu.css(this.DEFAULT_CLASS.menu),a&&(a.appendTo(this.menu),this.select(this.options.defaultSelected)),this.menu},updateContent:function(a,b){var c="[data-id="+a.id+"][data-level="+a.level+"]";this.menu.find(c).html(b)},reset:function(a){this.options=a,this.checkOptions(),this.menu.empty(),this.render()}},f});
//# sourceMappingURL=awesome-menu.min.js.map